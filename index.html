<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CheroMarket SV | Tienda Oficial</title>

<style>
:root {
    --azul:#0047AB;
    --naranja:#FF8C00;
    --verde-wa:#25D366;
    --fondo:#f0f2f5;
    --tarjeta-bg:#ffffff;
    --texto:#333;
    --texto-sec:#777;
    --borde:#ddd;
}

[data-theme="dark"] {
    --fondo:#121212;
    --tarjeta-bg:#1e1e1e;
    --texto:#e0e0e0;
    --texto-sec:#aaa;
    --borde:#333;
    --azul:#4c8cff;
}

body {
    font-family:'Segoe UI',sans-serif;
    margin:0;
    background:var(--fondo);
    color:var(--texto);
    padding-bottom:80px;
}

header {
    background:var(--tarjeta-bg);
    padding:15px 10px;
    text-align:center;
    border-bottom:3px solid var(--azul);
    position:sticky;
    top:0;
    z-index:100;
}

h1 {
    margin:0;
    color:var(--azul);
    font-size:22px;
}

.sub {
    font-size:13px;
    color:var(--texto-sec);
    margin-top:3px;
}

.buscador-cont {
    max-width:500px;
    margin:10px auto 0;
    display:flex;
    gap:8px;
}

.buscador {
    flex:1;
    padding:12px;
    border-radius:25px;
    border:1px solid var(--borde);
    background:var(--fondo);
    color:var(--texto);
}

.btn-theme {
    width:40px;
    height:40px;
    border:none;
    border-radius:50%;
    cursor:pointer;
}

.categorias-bar {
    display:flex;
    gap:10px;
    overflow-x:auto;
    padding:12px 10px;
    max-width:500px;
    margin:auto;
}

.cat-btn {
    padding:8px 15px;
    border:none;
    border-radius:20px;
    font-size:13px;
    font-weight:600;
    background:var(--borde);
    cursor:pointer;
}

.cat-btn.active {
    background:var(--azul);
    color:white;
}

.feed {
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
    padding:12px;
    max-width:900px;
    margin:auto;
}

.tarjeta {
    background:var(--tarjeta-bg);
    border-radius:12px;
    overflow:hidden;
    border:1px solid var(--borde);
    display:flex;
    flex-direction:column;
}

.foto {
    height:180px;
    object-fit:contain;
    background:#f8f8f8;
    padding:10px;
}

.info {
    padding:12px;
    display:flex;
    flex-direction:column;
    gap:6px;
    flex-grow:1;
}

.tag-cat {
    font-size:10px;
    border:1px solid var(--azul);
    color:var(--azul);
    padding:2px 8px;
    border-radius:6px;
    font-weight:600;
    align-self:flex-start;
}

.titulo {
    font-size:15px;
    font-weight:600;
    line-height:1.3;
}

.precio {
    font-size:20px;
    font-weight:700;
    color:var(--naranja);
}

.moneda {
    font-size:12px;
    color:var(--texto-sec);
    margin-right:4px;
}

.lugar {
    font-size:12px;
    color:var(--texto-sec);
}

.btn-contacto {
    background:var(--verde-wa);
    color:white;
    text-decoration:none;
    text-align:center;
    padding:11px;
    border-radius:8px;
    font-weight:600;
    margin-top:auto;
}

.btn-vender {
    position:fixed;
    bottom:20px;
    right:20px;
    width:65px;
    height:65px;
    border-radius:50%;
    background:var(--naranja);
    color:white;
    border:none;
    font-size:32px;
    cursor:pointer;
}

/* Modal */
#modal {
    position:fixed;
    inset:0;
    background:var(--fondo);
    display:none;
    z-index:200;
}

form {
    max-width:500px;
    margin:auto;
    padding:20px;
    display:flex;
    flex-direction:column;
    gap:14px;
}

input,select {
    padding:12px;
    border-radius:8px;
    border:1px solid var(--borde);
}

.btn-publicar {
    background:var(--naranja);
    color:white;
    padding:15px;
    border:none;
    border-radius:8px;
    font-size:16px;
    font-weight:700;
    cursor:pointer;
}
</style>
</head>

<body data-theme="light">

<header>
<h1>ðŸ‡¸ðŸ‡» CheroMarket SV</h1>
<div class="sub">Tienda oficial Â· Productos verificados</div>

<div class="buscador-cont">
<input id="buscar" class="buscador" placeholder="Buscar productosâ€¦" oninput="filtrar()">
<button class="btn-theme" onclick="toggleTheme()">ðŸŒ“</button>
</div>

<div class="categorias-bar">
<button class="cat-btn active" onclick="setCat('Todos',this)">Todos</button>
<button class="cat-btn" onclick="setCat('TecnologÃ­a',this)">TecnologÃ­a</button>
<button class="cat-btn" onclick="setCat('Ropa',this)">Ropa</button>
<button class="cat-btn" onclick="setCat('Comida',this)">Comida</button>
</div>
</header>

<div id="feed" class="feed"></div>

<button class="btn-vender" onclick="abrir()">+</button>

<div id="modal">
<form>
<h3>Publicar producto</h3>

<input id="titulo" placeholder="Nombre del producto" required>
<input id="precio" type="number" step="0.01" placeholder="Precio USD">
<select id="categoria">
<option>TecnologÃ­a</option>
<option>Ropa</option>
<option>Comida</option>
</select>
<select id="depto">
<option>San Salvador</option>
<option>La Libertad</option>
<option>Santa Ana</option>
</select>
<input type="file" id="foto" accept="image/*" onchange="preview(event)">
<img id="prev" style="display:none;border-radius:10px">

<button type="button" class="btn-publicar" onclick="publicar()">Publicar</button>
<button type="button" onclick="cerrar()">Cancelar</button>
</form>
</div>

<script>
const VENDEDOR = {
    nombre:"CheroMarket SV",
    whatsapp:"77771234"
};

let imagen="";
let categoria="Todos";

function toggleTheme(){
    document.body.dataset.theme =
    document.body.dataset.theme === "dark" ? "light":"dark";
}

function abrir(){ modal.style.display="block"; }
function cerrar(){ modal.style.display="none"; }

function preview(e){
    const r=new FileReader();
    r.onload=()=>{ prev.src=r.result; prev.style.display="block"; imagen=r.result; }
    r.readAsDataURL(e.target.files[0]);
}

function publicar(){
    const p={
        id:Date.now(),
        titulo:titulo.value,
        precio:parseFloat(precio.value).toFixed(2),
        categoria:categoria.value,
        depto:depto.value,
        telefono:VENDEDOR.whatsapp,
        vendedor:VENDEDOR.nombre,
        foto:imagen||"https://via.placeholder.com/400"
    };

    const db=JSON.parse(localStorage.getItem("db"))||[];
    db.unshift(p);
    localStorage.setItem("db",JSON.stringify(db));
    cerrar();
    render(db);
}

function setCat(c,b){
    categoria=c;
    document.querySelectorAll('.cat-btn').forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
    filtrar();
}

function filtrar(){
    const t=buscar.value.toLowerCase();
    const db=JSON.parse(localStorage.getItem("db"))||[];
    render(db.filter(p=>
        p.titulo.toLowerCase().includes(t) &&
        (categoria==="Todos"||p.categoria===categoria)
    ));
}

function render(lista){
    feed.innerHTML="";
    lista.forEach(p=>{
        feed.innerHTML+=`
        <div class="tarjeta">
            <img src="${p.foto}" class="foto">
            <div class="info">
                <span class="tag-cat">${p.categoria}</span>
                <div class="titulo">${p.titulo}</div>
                <div class="precio"><span class="moneda">USD</span>$${p.precio}</div>
                <div class="lugar">Vendedor: ${p.vendedor}</div>
                <div class="lugar">UbicaciÃ³n: ${p.depto}</div>
                <a class="btn-contacto" target="_blank"
                href="https://wa.me/503${p.telefono}?text=Hola, estoy interesado en el producto '${p.titulo}'.">
                Contactar vendedor</a>
            </div>
        </div>`;
    });
}

render(JSON.parse(localStorage.getItem("db"))||[]);
</script>

</body>
</html>